/*********************************************************************/
/*   PURPOSE: ??????????????                                         */
/*   AUTHOR:  UNKNOWN                CREATION DATE: 04/19/1991       */
/*   TYPICAL USER(S): USERGN USERO5 BC0JASS USERA2 USERCB USERD1     */
/*   PARAMETERS PASSED: NONE                                         */
/*   CDC COMPLIANCE: NO DATE DEPENDENCIES                            */
/*********************************************************************/
/*   MAINTENANCE RECORD: LAST 3 CHANGES                              */
/*********************************************************************/
/*   DATE    LOGONID REASON FOR CHANGE & WHAT WAS DONE               */
/*-------------------------------------------------------------------*/
/*01/22/1996 USER87  UNKNOWN                                         */
/*08/18/1998 BC0THOR ADDED THIS COMMENT BLOCK                        */
/*                                                                   */
/*********************************************************************/
PROC 0
/*      CALL 'TEST.LOAD(CLISTMON)' 'XREF    '  */
CONTROL NOFLUSH NOMSG NOLIST
FREEALL
SET MSG = &MSG
SET P =
SET &P = &STR((+1))
FREE FI(XREF)
FREE FI(XREF1)
FREE FI(SEQIN) DA('BC0THOR.DEL.XREF.OUTPUT')
DEL &SYSUID..XREF
DEL &SYSUID..XREF1
SET CNTR = 4
E1:SET &DSN =
ISPEXEC CONTROL DISPLAY REFRESH
ISPEXEC DISPLAY PANEL(XREF1) MSG(&MSG)
VPUT (&GROUPID &NAME) PROFILE
IF &DSN =  THEN GOTO E1
IF &DSN = QUIT THEN GOTO EXIT
SET LEN = &LENGTH(&DSN)
ALLOC FI(XREF) DA(&SYSUID..XREF) DELETE UNIT(DISK) SPACE(5,1) -
                       TRACK RECFM(F B) LRECL(80) BLKSIZE(80)
OPENFILE XREF OUT
SET &XREF = &STR(&DSN)
PUTFILE XREF
CLOSFILE XREF
SET &H =
ISPEXEC CONTROL DISPLAY REFRESH
ISPEXEC DISPLAY PANEL(XREF2) MSG(&MSG)
IF &H = 2 THEN DO
  ISPEXEC CONTROL DISPLAY REFRESH
  ISPEXEC DISPLAY PANEL(XREF3) MSG(&MSG)
  DEL &SYSUID..XREF1
  ALLOC DA(&SYSUID..XREF1) NEW UNIT(DISK) SPACE(5,5) TRACK -
                           RECFM(F B) LRECL(80) BLKSIZE(80)
  IF &LASTCC¬= 0 THEN DO
       CLR
       WRITE
       WRITE
       WRITE
       WRITE   INTERNAL ERROR AT POINT 1
       WRITE   FOR &SYSUID..&SYSUID..XREF1.
       WRITE
       WRITE   UNCATALOG THIS DATASET AND
       WRITE   EXECUTE UTILITY AGAIN OR
       WRITE   CONTACT JCL PROGRAMMER.
       WRITE
       WRITE
       GOTO EXIT
  END
  ALLOC FI(SEQOUT) DA(&SYSUID..XREF1) SHR
  IF &LASTCC¬= 0 THEN DO
       CLR
       WRITE
       WRITE
       WRITE
       WRITE   INTERNAL ERROR AT POINT 2
       WRITE   FOR &SYSUID..&SYSUID..XREF1
       WRITE   CONTACT JCL PROGRAMMER
       WRITE
       WRITE
       GOTO EXIT
  END
  ALLOC FI(SEQIN) DA('BC0THOR.DEL.XREF.OUTPUT') SHR
  IF &LASTCC¬= 0 THEN DO
       CLR
       WRITE
       WRITE
       WRITE
       WRITE   INTERNAL ERROR AT POINT 3
       WRITE   FOR PROD.XREF
       WRITE   CONTACT JCL PROGRAMMER
       WRITE
       WRITE
       GOTO EXIT
  END
  ALLOC FI(CONTROL) DA(&SYSUID..XREF) DELETE
  IF &LASTCC¬= 0 THEN DO
       CLR
       WRITE
       WRITE
       WRITE
       WRITE   INTERNAL ERROR AT POINT 4
       WRITE   FOR &SYSUID..&SYSUID..XREF
       WRITE   CONTACT JCL PROGRAMMER
       WRITE
       WRITE
       GOTO EXIT
  END
  CALL 'BC0THOR.LOAD.LOAD(RUX7005P)'
  ISPEXEC BROWSE DATASET(&SYSUID..XREF1)
  FREE FI(XREF)
  FREE FI(XREF1)
  DEL &SYSUID..XREF
  DEL &SYSUID..XREF1
  GOTO EXIT
END
IF &H = 1 THEN DO
 ISPEXEC FTOPEN TEMP
 ISPEXEC FTINCL XREF2
 ISPEXEC FTCLOSE
 ISPEXEC VGET ZTEMPF
 ISPEXEC CONTROL DISPLAY LINE START(1)
CONTROL   MSG
 SUBMIT '&ZTEMPF.'
CONTROL NOMSG
 SET &MSG =
 GOTO EXIT
END
IF &H = X THEN GOTO EXIT
EXIT: FREEALL
